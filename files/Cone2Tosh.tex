\section{Singularities of codimension 2}\label{sec:codmi=2}

\subsection{Gauss and mean curvature estimates}

\begin{thm}{Theorem}\label{thm:extimage-of-G-and-H}
Let $f$, $h$ be a pair of strongly convex smooth 1-Lipschitz functions defined on an open set of a 3-dimensional Riemannian manifold.
Suppose that (1)
\[|\nabla (f+h)|<\eps\cdot|\nabla f|\quad\text{and}\quad |\nabla f|\ge 1\] 
for some fixed positive $\eps<\tfrac12$
and (2) for some $a,b\in \RR$, the set
\[W_{a,b}=\set{p\in M}{f(p)=a, h(p)\le b}\]
is compact.
Denote by $k_1(p)\le k_2(p)$ the principle curvatures of $W_{a,b}$ at a point $p\in W_{a,b}$.
Let $H(p)=k_1(p)+ k_2(p)$ and
$G(p)=k_1(p)\cdot k_2(p)$ its mean and Gauss curvatures.
Then
\[\int_{W_{a,b}}G\le 100\cdot\eps
\eqlbl{intG<100eps}\]
and 
\[\int_{W_{a,b}}H\le 10\cdot \sqrt{\eps}\cdot \length(\partial{W_{a,b}}).
\eqlbl{intH<eps}\]
\end{thm}

The proof is based on the 2-dimesional case  following statement,
which is the integral Bochner formula written for function with Dirichlet boundary condition.

\begin{thm}{Proposition}\label{prop:bochner-dirichle}
Assume $\Omega$ is a compact domain with smooth boundary $\partial \Omega$ in a Riemannian manifold
and $f$ is a smooth function that vanish on $\partial \Omega$.
Then
\[\int\limits_\Omega |\Delta f|^2
-|\Hess f|^2
-\langle\mathrm{Ric}(\nabla f),\nabla f\rangle
=\int\limits_{\partial\Omega}
H\cdot|\nabla f|^2,\]
where $H$ denotes mean curvature of $\partial \Omega$.
\end{thm}

\parit{Proof.}
Equip $W_{a,b}$ with unit normal vector field $n=\tfrac{\nabla f}{|\nabla f|}$.
Let $S_p\:\T_pW_{a,b}\zz\to \T_pW_{a,b}$ be the corresponding shape operator, so $S_p\:v\mapsto\nabla_vn$.
Since $f$ is strongly convex, we have that 
\[\langle S_p(v),v\rangle\ge \delta\cdot|v|^2\]
for a fixed value $\delta>0$ and any tangent vector $v\in \T_pW_{a,b}$. 

Note that the restriction of $u=h|_{W_{a,b}}$ is strongly convex.
Moreover 
\[\Hess_pu(v,v)\ge (1-\eps)\cdot \langle S_p(v),v\rangle\eqlbl{Hess=<shape}\]
for any $p\in W_{a,b}$ and $v\in\T_pW_{a,b}$.

Indeed, consider the geodesic $\gamma$ in $W_{a,b}$ such $\gamma(0)=p$ and $\gamma'(0)=v$.
Set $a=\gamma''(t)$.
Note that 
\begin{align*}
a&=-\langle S_p(v),v\rangle \cdot n,
\intertext{Since $h$ is is strongly convex, $\Hess_p h\ge 0$; therefore}
(\Hess_pu)(v,v)&=(\Hess_p h)(v,v)+\langle \nabla_p h,a\rangle\ge
\\
&\ge-\tfrac{\langle\nabla_p h,\nabla_p f\rangle}{|\nabla_p f|}\cdot\langle S_p(v),v\rangle\ge
\\
&\ge (1-\eps)\cdot|\nabla_p f|\cdot\langle S_p(v),v\rangle.
\end{align*}
Since $\nabla f\ge 1$, \ref{Hess=<shape} follows.

Since $\langle S_p(v),v\rangle\ge 0$ and $\eps<\tfrac12$, the inequality \ref{Hess=<shape} implies that 
\[4\cdot \det(\Hess_pu)\ge G(p)
\eqlbl{eq:det>=G}\]
and
\[-2\cdot \Delta u\ge H(p)
\eqlbl{eq:trace>=H}\]
for any $p\in W_{a,b}$.

Denote by  $\lambda_1(p),\lambda_2(p)$ the eigenvalues of  $\Hess_p u$, so
\begin{align*}
\trace(\Hess u)&=\Delta u=\lambda_1+\lambda_2,
\\
|\Hess u|^2&=\lambda_1^2+\lambda_2^2,
\\
\det(\Hess u)&=\lambda_1\cdot\lambda_2.
\end{align*}
Therefore 
\[2\cdot\det(\Hess u)
=|\Delta u|^2
-|\Hess u|^2.\] 

Since $W_{a,b}$ is two-dimensional, by Proposition~\ref{prop:bochner-dirichle} we get that
\[\int\limits_{W_{a,b}} 
2\cdot\det(\Hess u)
=\int\limits_{W_{a,b}} 
K\cdot|\nabla u|^2
+
\int\limits_{\partial W_{a,b}}
\kappa\cdot|\nabla u|^2,\]
where $\kappa\ge 0$ is the geodesic curvature of $\partial W_{a,b}$
and $K$ is the curvature of $W_{a,b}$.

Since $u$ is convex and vanish on the boundary of $W_{a,b}$,
it has unique critical point, which is its minimum.
By Morse lemma,  $W_{a,b}$ is a disc.
Therefore, by Gauss--Bonnet formula, we get that
\[\int_{W_{a,b}} K+\int_{\partial{W_{a,b}}}\kappa=2\cdot\pi.\]
Whence 
\[\int\limits_{W_{a,b}} 
\det(\Hess u)
\le\pi\cdot\sup_{p\in{W_{a,b}}}|\nabla_p u|^2.\]

Note that $\nabla_p u$ is projection of $\nabla_ph$ to $\T_pW_{a,b}$.
Therefore
\begin{align*}
|\nabla_p u|^2&=|\nabla_p h|^2-\langle\nabla_p h,n\rangle^2\le
\\
&\le1-(1-\eps)^2<
\\
&<2\cdot\eps.
\end{align*}
It follows that 
\[\int\limits_{W_{a,b}} 
\det(\Hess u)
\le2\cdot \pi\cdot\eps.\]
Applying \ref{eq:det>=G}, we obtain \ref{intG<100eps}.

Similarly,  by the divergence theorem, we get that
\[-\int\limits_{W_{a,b}} \Delta u=\int\limits_{\partial{W_{a,b}}} |\nabla u|.\]
Whence \ref{eq:trace>=H} implies 
\[\int\limits_{W_{a,b}} H\le 10\cdot \sqrt{\eps}\cdot \length(\partial{W_{a,b}}).\]
\qeds

\subsection{Curvature of level sets}

Let $M$ be a 3-dimensional Riemannian manifold.
Choose a smooth function $f$.
Denote by $L_c$ the level set of $f$;
that is,
\[L_c=\set{x\in M}{f(x)=c}.\]
If the level set $L_c$ is a smooth surface in a neighborhood of $x\in L_c$,
then denote by $k_1(x)\le k_2(x)$ the principle curvatures of $L_c$ at $x$.
In this case, set 
\begin{align*}
G_f(x)&=k_1(x)\cdot k_2(x),
\\
H_f(x)&=k_1(x)+ k_2(x);
\end{align*}
that is, $G_f(x)$ and $H_f(x)$ are Gauss and mean curvature of $L_c$ at $x$.

\begin{thm}{Theorem}\label{thm:HG-converge}
Let $M_n$ be a sequence of $3$-dimensional Riemannian manifolds
and $f_n\: M_n\to \RR$ be a sequence of strongly concave functions.
Suppose that $\sec M_n\ge -\tfrac1n$ for each $n$, $M_n\zz\to \RR\times A$ without collapsing and $f_n$ converges to the $\RR$-coordinate in $\RR\times A$ as $n\to \infty$.
Then $G_{f_n}$ and $H_{f_n}$ weakly converge to zero.
\end{thm}

\parit{Proof.}
Choose $p\in \RR\times A$; set $a=f(p)$.

By theorem of Artem Nepechiy \cite{Nepechiy},
there is a $(-2)$-concave function $\rho$ defined in an $r$-neighborhood of $p$ such that $\rho(x)=-|p-x|^2+o(|p-x|^2)$.
Moreover, the function $\rho$ is \emph{liftable};
that is, there is a sequence of $(-2)$-concave $\rho_n\:M_n\to\RR$ that converges to $\rho$.

Consider a point $q\in \RR\times A$ above $p$; that is, its $\RR$-coordinate is larger and its $A$-coordinate is the same.
If $\RR$-coordinate of $q$ is large then $\dist_q+f$ is $\lambda$-concave for small $\lambda>0$ and it has a nonstrict minimum at $p$.
Therefore, given $\lambda>0$, we can find $q$ so that the sum $s=f+\dist_q+\lambda\cdot \rho$ is $(-\lambda)$-concave and has strict maximum at $p$.
Moreover
\[-\lambda\cdot|p-x|_A^2\ge s(x)-s(p)\ge -\tfrac12\cdot\lambda\cdot|p-x|_A^2\]
and therefore
\[|\nabla_xs|\le 10\cdot\lambda\cdot|p-x|_A
\eqlbl{O(p-x)}\]
if $|p-x|_A$ is sufficiently small; say if $|p-x|_A\le \tfrac r{10}$.

Choose a sequence of points $q_n\in M_n$ that converges to $q$ and set $h_n\zz=\dist_{q_n}+\lambda\cdot \rho_n$;
this is a sequence of liftings of $h=\dist_q+\lambda\cdot \rho$. 
Observe that \ref{O(p-x)} implies that the first condition in \ref{thm:extimage-of-G-and-H} is met for all large $n$ in an $\tfrac r2$-neighborhood of $p_n$ with $\eps=10\cdot\lambda\cdot r$.
Moreover, one can choose $b$ so that the second condition is satisfied and $B_n=B(p_n,r/10)\cap L_a\subset W_{a,b}$.
Applying \ref{thm:extimage-of-G-and-H}, we get that for any $\delta>0$, we have 
\[
\int_{B_n}G_{f_n}<\delta,
\quad\text{and}\quad
\int_{B_n}H_{f_n}<\delta.
\]
for all large $n$.
It remains to integrate the obtained inequalities by $a$ and pass to a limit as $n\to\infty$.
\qeds

\begin{thm}{Corollary}\label{cor:Ricci}
Suppose that $M_n\to  \RR\times A$ and $f_n\: M_n\to \RR$ be as in \ref{thm:HG-converge}.
Set $u_n=\tfrac{\nabla f_n}{|\nabla f_n|}$.
Then 

\begin{enumerate}
\item\label{cor:Ricci:Ricci} $\langle \Ric u_n,u_n\rangle$ weakly converges to zero.
\item\label{cor:Ricci:vw}
Let $v_n$ and $w_n$ are sequences of uniformly bounded, continuous vector fields on $M_n$.
Suppose that $\langle v_n,u_n\rangle$ and $\langle w_n,u_n\rangle$ converge uniformly as $n\to \infty$ to some constants $a$ and $b$ respectively.
Then 
\[q(v_n,w_n)\rightharpoonup a\cdot b\cdot \haus_1\oplus \kappa,\]
where $\kappa$ is the curvature measure on $A$ and $\haus_1$ is 1-dimensional Haudorff mearure on $\RR$.

\end{enumerate}

\end{thm}

\parit{Proof; (\ref{cor:Ricci:Ricci}).}
Passing to a subsequence if nesessary, we can assume weak convergence $\langle \Ric u_n,u_n\rangle\cdot\vol_m$ to a measure $\mu$ on $A$.
Since $\sec M_n\ge -\tfrac1n$, we have that $\mu\ge 0$.
Therefore it is sufficient to show that $\mu\le 0$.

By \ref{thm:bochner-formula} we have that the following equality
\[\int\limits_\Omega \phi_n\cdot \langle \Ric u_n,u_n\rangle =
\int\limits_\Omega [\phi_n \cdot G_{f_n}+H_{f_n}\cdot\<u_n,\nabla\phi_n\>-\<\nabla\phi_n,\nabla_{u_n} {u_n}\>]
\]
holds for any function $\phi_n$ with compact support on $M_n$,
assuming that all expressions in the formula have sense.

It is remains to find a sequence of nonnegative function $\phi_n\:M_n\to \RR$ 
with compact support 
that converge to a $\phi\:A\to \RR$ such that (1) $\phi$ is unit in a neighborhood of a given point $p\in A$ and (2) we have a control the three terms on the right hand side of the formula; that is, we have the following weak convergences:
\[
\begin{aligned}
\phi_n \cdot G_{f_n}&\rightharpoonup 0,
&
H_{f_n}\cdot\<u_n,\nabla\phi_n\>&\rightharpoonup 0,
&
\<\nabla\phi_n,\nabla_{u_n} {u_n}\>&\rightharpoonup 0.
\end{aligned}
\eqlbl{eq:3->0}
\]

For the first convergence, it is sufficient to choose the sequence $\phi_n$ so that in addition it is universally bounded.
Indeed, according to \ref{lem:smooth-covergence}, $|\nabla f_n|\to 1$.
Therefore \ref{thm:HG-converge} and the coarea formula %???coarea formula
implies the first convergence in \ref{eq:3->0}.

Similarly, to prove the second convergence in \ref{eq:3->0}, it is sufficient to assume in addition that $|\nabla\phi_n|$ is universally bounded and apply \ref{thm:HG-converge} together with the coarea formula.

To prove the last convergence in \ref{eq:3->0}, note that \ref{lem:smooth-covergence} implies weak convergence
$|\nabla u|\rightharpoonup 0$ away from the singular locus.
This observation is used to control the term $\<\nabla\phi_n,\nabla_{u_n} {u_n}\>$ at the points far from the singular locus of $A$ --- we only need to assume that $|\nabla\phi_n|$ is bounded.

Further, since $|u_n|=1$, we have $\nabla_{u_n} u_n\perp \nabla f_n$.
Therefore if $\nabla \phi_n$ is proportional to $\nabla f_n$ at some point, then at this point we have $\<\nabla\phi_n,\nabla_{u_n} {u_n}\>=0$.
This observation makes it possible to choose $\phi_n$ so that the term $\<\nabla\phi_n,\nabla_{u_n} {u_n}\>$ vanish around the singular locus of $A$.
Namely in addition to the above conditions on $\phi_n$ we have to assume that the identity $\phi_n=\psi\circ f_n$ holds at the points of $M_n$ that are sufficiently close to the singular locus of $A$.

Finally observe that the needed sequence exists.
Indeed, one can take 
\[\phi_n=(\sigma\circ \dist_q)\cdot \psi\cdot f_n\]
for appropriately chosen fixed mollifiers $\sigma,\psi\:\RR\to \RR$.

\parit{(\ref{cor:Ricci:vw}).}
Since $G_{f_n}\rightharpoonup 0$, we get that curvature measure of level sets of $f_n$ weakly converges to the curvaure of $A$.
It follows that 
\[q(u_n,u_n)\rightharpoonup \haus_1\oplus \kappa.\]

Suppose $v'_n\perp u_n$ for all $n$.
Part (\ref{cor:Ricci:Ricci}) implies that  $q(v'_n,v'_n)\rightharpoonup 0$.

Fix $t\in \RR$.
Since the lower bound on sectional curvature of $M_n$ converges to $0$, any partial weak limit of $q(v'_n+t\cdot w_n,v'_n+t\cdot w_n)$ is nonnegative.
It follows that 
\[q(v'_n, w_n)\rightharpoonup 0\] for any sequence of fields $v'_n,w_n$ such that $v'_n\perp u_n$.

Consider the vector fields $v_n',w_n'$ such that 
\begin{align*}
v'_n&\perp u_n,
&
v_n&=a_n\cdot u_n+v_n',
\\
w'_n&\perp u_n,
&
w_n&=b_n\cdot u_n+w_n'.
\end{align*}
Since $q$ is bilinear, we get that
\[q(v_n,w_n)=q(v_n',w_n) + a_n\cdot [q(u_n,w_n')+ b_n\cdot q(u_n,u_n)].\]
By assumption, that $a_n=\langle u_n,v_n\rangle $ and $b_n=\langle u_n,w_n\rangle$ uniformly converge to $a$ and $b$ respectively.
Whence the statement follows.
\qeds


